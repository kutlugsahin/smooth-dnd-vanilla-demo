{"version":3,"sources":["..\\smooth-dnd\\src\\polyfills.js","..\\smooth-dnd\\src\\utils.js","..\\smooth-dnd\\src\\constants.js","..\\smooth-dnd\\src\\styles.js","..\\smooth-dnd\\src\\dragscroller.js","..\\smooth-dnd\\src\\mediator.js","..\\smooth-dnd\\src\\layoutManager.js","..\\smooth-dnd\\src\\dropHandlers.js","..\\smooth-dnd\\src\\container.js","src\\utils.js","src\\index.js"],"names":["constructor","prototype","matches","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","s","document","ownerDocument","querySelectorAll","i","length","item","global","Node","Element","firstElementChild","Object","defineProperty","get","node","nodes","childNodes","nodeType","Array","some","fun","TypeError","t","len","thisArg","arguments","call","getIntersection","rect1","rect2","left","Math","max","top","right","min","bottom","getIntersectionOnAxis","axis","getContainerRect","_rect","element","getBoundingClientRect","rect","hasBiggerChild","isScrollingOrHidden","width","scrollWidth","height","scrollHeight","getScrollingAxis","style","getComputedStyle","overflow","general","overFlowX","xScroll","overFlowY","yScroll","isScrolling","overFlowAxis","dimensionScroll","clientWidth","clientHeight","hasScrollBar","getVisibleRect","elementRect","currentElement","parentElement","listenScrollParent","clb","scrollers","dispose","forEach","p","removeEventListener","setTimeout","addEventListener","push","hasParent","parent","current","getParent","selector","hasClass","cls","className","split","map","indexOf","addClass","classes","filter","unshift","join","removeClass","debounce","fn","delay","immediate","timer","params","clearTimeout","removeChildAt","index","removeChild","children","addChildAt","child","lenght","appendChild","insertBefore","isMobile","window","navigator","userAgent","match","clearSelection","getSelection","empty","removeAllRanges","selection","containerInstance","containersInDraggable","defaultGroupName","wrapperClass","defaultGrabHandleClass","animationClass","translationValue","visibilityValue","ghostClass","containerClass","extraSizeForInsertion","stretcherElementClass","stretcherElementInstance","isDraggableDetached","disbaleTouchActions","noUserSelectClass","originalTrasitionDuration","constants","verticalWrapperClass","horizontalWrapperClass","css","convertToCssString","keys","reduce","styleString","propName","propValue","addStyleToHead","head","getElementsByTagName","createElement","cssString","type","styleSheet","cssText","createTextNode","maxSpeed","minSpeed","addScrollValue","value","scrollLeft","scrollTop","scrollBy","createAnimator","isAnimating","request","startTime","direction","speed","animate","_direction","_speed","start","requestAnimationFrame","timestamp","timeDiff","distanceDiff","stop","cancelAnimationFrame","getAutoScrollInfo","position","scrollableInfo","x","y","begin","end","pos","moveDistance","speedFactor","result","descendants","invalidate","getScrollableElements","containerElements","scrollables","firstDescendentScrollable","el","scrollingAxis","info","assign","getScrollableAnimator","getWindowAnimators","getWindowRect","innerWidth","innerHeight","containers","scrollablesInfo","animators","draggableInfo","reset","scrollParams","mousePosition","animator","Utils","grabEvents","moveEvents","releaseEvents","dragListeningContainers","grabbedElement","ghostInfo","isDragging","removedElement","handleDrag","handleScroll","sourceContainer","sourceContainerLockAxis","listenEvents","listen","addGrabListeners","removeGrabListeners","e","onMouseDown","passive","addMoveListeners","onMouseMove","removeMoveListeners","addReleaseListeners","onMouseUp","removeReleaseListeners","getGhostParent","body","getGhostElement","wrapperElement","container","cursor","getScale","scaleX","scaleY","midX","midY","ghost","cloneNode","zIndex","boxSizing","transition","removeProperty","pointerEvents","getOptions","dragClass","orientation","centerDelta","positionDelta","getDraggableInfo","draggableElement","draggableIndex","draggables","elementIndex","payload","getChildPayload","undefined","targetElement","groupName","handleDropAnimation","callback","endDrop","transitionDuration","animateGhostToPosition","duration","dropClass","shouldAnimateDrop","options","dragResult","getDragResult","shadowBeginEnd","animationDuration","behaviour","removedIndex","elementSize","layout","getTranslateCalculator","addedIndex","prevDraggableEnd","getBeginEnd","getBeginEndOfContainer","getTopLeftOfElementBegin","opacity","transform","handleDragStartConditions","startEvent","moveThreshold","maxMoveInDelay","onMove","event","getPointerEvent","currentX","clientX","currentY","clientY","abs","callCallback","deregisterEvent","onUp","onHTMLDrag","registerEvents","_startEvent","_delay","_clb","button","target","containerElement","dragHandleSelector","nonDragAreaSelector","startDrag","dragBeginDelay","initiateDrag","fireOnDragStartEnd","handleDrop","touches","dragHandler","targetContainers","containerBoxChanged","invalidateRects","onTranslated","getScrollHandler","autoScrollEnabled","isStart","onDragStart","onDragEnd","isSource","isDragRelevant","willAcceptDrop","setDraggables","lockAxis","toLowerCase","prepareDrag","preventDefault","Mediator","register","unregister","splice","layoutManager","horizontalMap","size","distanceToParent","translate","dragPosition","scrollSize","offsetSize","scrollValue","scale","setSize","setters","val","verticalMap","orientationDependentProps","obj","prop","mappedProp","set","_animationDuration","propMapper","values","translation","registeredScrollListener","invalidateContainerRectangles","scrollListener","invalidateContainerScale","visibleRect","offsetWidth","offsetHeight","getContainerRectangles","getBeginEndOfDOMRect","getBeginEndOfContainerVisibleRect","getContainerScale","getSize","getDistanceToOffsetParent","distance","getAxisValue","updateDescendantContainerRects","getChildContainers","setTranslation","getTranslation","setVisibility","isVisible","visibility","isInVisibleRect","containerRect","setScrollListener","getScrollSize","getScrollValue","setScrollValue","parentNode","getPosition","domDropHandler","reactDropHandler","dropResult","onDrop","handler","defaultOptions","shouldAcceptDrop","setAnimation","add","getPropertyValue","setProperty","getContainer","initOptions","props","sourceOptions","parentWrapper","wrapChild","SmoothDnD","wrapChildren","ELEMENT_NODE","wrapper","unwrapChildren","findDraggebleAtPos","find","startIndex","endIndex","withRespectToMiddlePoints","middleIndex","floor","resetDraggables","setTargetContainer","draggablesReset","dropHandler","actualAddIndex","dropHandlerParams","droppedElement","getContainerProps","initialOptions","getRelaventParentContainer","relevantContainers","containerOfParentElement","draggable","registerToParentContainer","parentInfo","setParentContainer","getRemovedItem","prevRemovedIndex","setRemovedItemVisibilty","isPosInChildContainer","notifyParentOnPositionCapture","isCaptured","getParentContainer","onChildPositionCaptured","getElementSize","handleTargetContainer","getDragInsertionIndex","findDraggable","beginAdjustment","getDragInsertionIndexForDropZone","getShadowBeginEndForDropZone","prevAddedIndex","invalidateShadowBeginEndIfNeeded","shadowBoundsGetter","getShadowBeginEnd","invalidateShadow","getNextAddedIndex","getIndexForPos","resetShadowAdjustment","lastAddedIndex","handleInsertionSizeChange","strectherElement","containerBeginEnd","containerEnd","lastDraggableEnd","stretcherSize","toRemove","calculateTranslations","beforeIndex","afterBounds","beforeBounds","beforeSize","threshold","afterIndex","afterSize","shadowRectTopLeft","handleFirstInsertShadowAdjustment","fireDragEnterLeaveEvents","wasDragIn","isDragIn","onDragEnter","onDragLeave","dragLeft","getDragHandler","compose","getDefaultDragResult","functions","hydratedFunctions","Container","lastDraggableInfo","parentContainer","posIsInChildContainer","childContainers","processLastDraggableInfo","newDraggables","pop","handleDragLeftDeferedTranslation","sourceContainerOptions","containerIniter","initContainer","dndContainer","setOptions","newOptions","mergedOptions","applyDrag","arr","itemToAdd","generateItems","count","creator","lorem","columnNames","cardColors","pickColor","rand","random","createVerticalContainer","cardCount","card","innerText","slice","initScene","colCount","cardScene","querySelector","mainContainer","innerContainers","verticalContainerHolder","header","innerHTML","innerContainer","toFixed","verticalContainers","main","dropped","q","btn","getElementById"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AD3GO,IAAMuO,gCAAY,SAAZA,SAAY,CAACC,GAAD,EAAM5O,UAAN,EAAqB;AAAA,KACrCK,YADqC,GACCL,UADD,CACrCK,YADqC;AAAA,KACvBI,UADuB,GACCT,UADD,CACvBS,UADuB;AAAA,KACXvB,OADW,GACCc,UADD,CACXd,OADW;;AAE7C,KAAImB,iBAAiB,IAAjB,IAAyBI,eAAe,IAA5C,EAAkD,OAAOmO,GAAP;;AAElD,KAAMxU,sCAAawU,GAAb,EAAN;AACA,KAAIC,YAAY3P,OAAhB;;AAEA,KAAImB,iBAAiB,IAArB,EAA2B;AAC1BwO,cAAYzU,OAAOgK,MAAP,CAAc/D,YAAd,EAA4B,CAA5B,EAA+B,CAA/B,CAAZ;AACA;;AAED,KAAII,eAAe,IAAnB,EAAyB;AACxBrG,SAAOgK,MAAP,CAAc3D,UAAd,EAA0B,CAA1B,EAA6BoO,SAA7B;AACA;;AAED,QAAOzU,MAAP;AACA,CAhBM;;AAkBA,IAAM0U,wCAAgB,SAAhBA,aAAgB,CAACC,KAAD,EAAQC,OAAR,EAAoB;AAChD,KAAM5U,SAAS,EAAf;AACA,MAAK,IAAI3L,IAAI,CAAb,EAAgBA,IAAIsgB,KAApB,EAA2BtgB,GAA3B,EAAgC;AAC/B2L,SAAOjH,IAAP,CAAY6b,QAAQvgB,CAAR,CAAZ;AACA;AACD,QAAO2L,MAAP;AACA,CANM","file":"src.40de1316.map","sourceRoot":"..","sourcesContent":["(function(constructor) {\r\n  if (constructor && constructor.prototype && !constructor.prototype.matches) {\r\n    constructor.prototype.matches =\r\n      constructor.prototype.matchesSelector ||\r\n      constructor.prototype.mozMatchesSelector ||\r\n      constructor.prototype.msMatchesSelector ||\r\n      constructor.prototype.oMatchesSelector ||\r\n      constructor.prototype.webkitMatchesSelector ||\r\n      function(s) {\r\n        var matches = (this.document || this.ownerDocument).querySelectorAll(s),\r\n          i = matches.length;\r\n        while (--i >= 0 && matches.item(i) !== this) {}\r\n        return i > -1;\r\n      };\r\n  }\r\n})(global.Node || global.Element);\r\n\r\n// Overwrites native 'firstElementChild' prototype.\r\n// Adds Document & DocumentFragment support for IE9 & Safari.\r\n// Returns array instead of HTMLCollection.\r\n(function(constructor) {\r\n  if (\r\n    constructor &&\r\n    constructor.prototype &&\r\n    constructor.prototype.firstElementChild == null\r\n  ) {\r\n    Object.defineProperty(constructor.prototype, \"firstElementChild\", {\r\n      get: function() {\r\n        var node,\r\n          nodes = this.childNodes,\r\n          i = 0;\r\n        while ((node = nodes[i++])) {\r\n          if (node.nodeType === 1) {\r\n            return node;\r\n          }\r\n        }\r\n        return null;\r\n      }\r\n    });\r\n  }\r\n})(global.Node || global.Element);\r\n\r\n// Production steps of ECMA-262, Edition 5, 15.4.4.17\r\n// Reference: http://es5.github.io/#x15.4.4.17\r\nif (!Array.prototype.some) {\r\n  Array.prototype.some = function(fun /*, thisArg*/) {\r\n    \"use strict\";\r\n\r\n    if (this == null) {\r\n      throw new TypeError(\"Array.prototype.some called on null or undefined\");\r\n    }\r\n\r\n    if (typeof fun !== \"function\") {\r\n      throw new TypeError();\r\n    }\r\n\r\n    var t = Object(this);\r\n    var len = t.length >>> 0;\r\n\r\n    var thisArg = arguments.length >= 2 ? arguments[1] : void 0;\r\n    for (var i = 0; i < len; i++) {\r\n      if (i in t && fun.call(thisArg, t[i], i, t)) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n}\r\n","export const getIntersection = (rect1, rect2) => {\r\n  return {\r\n    left: Math.max(rect1.left, rect2.left),\r\n    top: Math.max(rect1.top, rect2.top),\r\n    right: Math.min(rect1.right, rect2.right),\r\n    bottom: Math.min(rect1.bottom, rect2.bottom)\r\n  };\r\n};\r\n\r\nexport const getIntersectionOnAxis = (rect1, rect2, axis) => {\r\n  if (axis === \"x\") {\r\n    return {\r\n      left: Math.max(rect1.left, rect2.left),\r\n      top: rect1.top,\r\n      right: Math.min(rect1.right, rect2.right),\r\n      bottom: rect1.bottom\r\n    };\r\n  } else {\r\n    return {\r\n      left: rect1.left,\r\n      top: Math.max(rect1.top, rect2.top),\r\n      right: rect1.right,\r\n      bottom: Math.min(rect1.bottom, rect2.bottom)\r\n    };\r\n  }\r\n};\r\n\r\nexport const getContainerRect = element => {\r\n  const _rect = element.getBoundingClientRect();\r\n  const rect = {\r\n    left: _rect.left,\r\n    right: _rect.right + 10,\r\n    top: _rect.top,\r\n    bottom: _rect.bottom\r\n  };\r\n\r\n  if (hasBiggerChild(element, \"x\") && !isScrollingOrHidden(element, \"x\")) {\r\n    const width = rect.right - rect.left;\r\n    rect.right = rect.right + element.scrollWidth - width;\r\n  }\r\n\r\n  if (hasBiggerChild(element, \"y\") && !isScrollingOrHidden(element, \"y\")) {\r\n    const height = rect.bottom - rect.top;\r\n    rect.bottom = rect.bottom + element.scrollHeight - height;\r\n  }\r\n\r\n  return rect;\r\n};\r\n\r\nexport const getScrollingAxis = element => {\r\n  const style = global.getComputedStyle(element);\r\n  const overflow = style[\"overflow\"];\r\n  const general = overflow === \"auto\" || overflow === \"scroll\";\r\n  if (general) return \"xy\";\r\n  const overFlowX = style[`overflow-x`];\r\n  const xScroll = overFlowX === \"auto\" || overFlowX === \"scroll\";\r\n  const overFlowY = style[`overflow-y`];\r\n  const yScroll = overFlowY === \"auto\" || overFlowY === \"scroll\";\r\n\r\n  return `${xScroll ? \"x\" : \"\"}${yScroll ? \"y\" : \"\"}` || null;\r\n};\r\n\r\nexport const isScrolling = (element, axis) => {\r\n  const style = global.getComputedStyle(element);\r\n  const overflow = style[\"overflow\"];\r\n  const overFlowAxis = style[`overflow-${axis}`];\r\n  const general = overflow === \"auto\" || overflow === \"scroll\";\r\n  const dimensionScroll = overFlowAxis === \"auto\" || overFlowAxis === \"scroll\";\r\n  return general || dimensionScroll;\r\n};\r\n\r\nexport const isScrollingOrHidden = (element, axis) => {\r\n  const style = global.getComputedStyle(element);\r\n  const overflow = style[\"overflow\"];\r\n  const overFlowAxis = style[`overflow-${axis}`];\r\n  const general =\r\n    overflow === \"auto\" || overflow === \"scroll\" || overflow === \"hidden\";\r\n  const dimensionScroll =\r\n    overFlowAxis === \"auto\" ||\r\n    overFlowAxis === \"scroll\" ||\r\n    overFlowAxis === \"hidden\";\r\n  return general || dimensionScroll;\r\n};\r\n\r\nexport const hasBiggerChild = (element, axis) => {\r\n  if (axis === \"x\") {\r\n    return element.scrollWidth > element.clientWidth;\r\n  } else {\r\n    return element.scrollHeight > element.clientHeight;\r\n  }\r\n};\r\n\r\nexport const hasScrollBar = (element, axis) => {\r\n  return hasBiggerChild(element, axis) && isScrolling(element, axis);\r\n};\r\n\r\nexport const getVisibleRect = (element, elementRect) => {\r\n  let currentElement = element;\r\n  let rect = elementRect || getContainerRect(element);\r\n  currentElement = element.parentElement;\r\n  while (currentElement) {\r\n    if (\r\n      hasBiggerChild(currentElement, \"x\") &&\r\n      isScrollingOrHidden(currentElement, \"x\")\r\n    ) {\r\n      rect = getIntersectionOnAxis(\r\n        rect,\r\n        currentElement.getBoundingClientRect(),\r\n        \"x\"\r\n      );\r\n    }\r\n\r\n    if (\r\n      hasBiggerChild(currentElement, \"y\") &&\r\n      isScrollingOrHidden(currentElement, \"y\")\r\n    ) {\r\n      rect = getIntersectionOnAxis(\r\n        rect,\r\n        currentElement.getBoundingClientRect(),\r\n        \"y\"\r\n      );\r\n    }\r\n\r\n    currentElement = currentElement.parentElement;\r\n  }\r\n\r\n  return rect;\r\n};\r\n\r\nexport const listenScrollParent = (element, clb) => {\r\n  let scrollers = [];\r\n  const dispose = () => {\r\n    scrollers.forEach(p => {\r\n      p.removeEventListener(\"scroll\", clb);\r\n    });\r\n    global.removeEventListener(\"scroll\", clb);\r\n  };\r\n\r\n  setTimeout(function() {\r\n    let currentElement = element;\r\n    while (currentElement) {\r\n      if (\r\n        isScrolling(currentElement, \"x\") ||\r\n        isScrolling(currentElement, \"y\")\r\n      ) {\r\n        currentElement.addEventListener(\"scroll\", clb);\r\n        scrollers.push(currentElement);\r\n      }\r\n      currentElement = currentElement.parentElement;\r\n    }\r\n\r\n    global.addEventListener(\"scroll\", clb);\r\n  }, 10);\r\n\r\n  return {\r\n    dispose\r\n  };\r\n};\r\n\r\nexport const hasParent = (element, parent) => {\r\n  let current = element;\r\n  while (current) {\r\n    if (current === parent) {\r\n      return true;\r\n    }\r\n    current = current.parentElement;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const getParent = (element, selector) => {\r\n  let current = element;\r\n  while (current) {\r\n    if (current.matches(selector)) {\r\n      return current;\r\n    }\r\n    current = current.parentElement;\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nexport const hasClass = (element, cls) => {\r\n  return (\r\n    element.className\r\n      .split(\" \")\r\n      .map(p => p)\r\n      .indexOf(cls) > -1\r\n  );\r\n};\r\n\r\nexport const addClass = (element, cls) => {\r\n  if (element) {\r\n    const classes = element.className.split(\" \").filter(p => p);\r\n    if (classes.indexOf(cls) === -1) {\r\n      classes.unshift(cls);\r\n      element.className = classes.join(\" \");\r\n    }\r\n  }\r\n};\r\n\r\nexport const removeClass = (element, cls) => {\r\n  if (element) {\r\n    const classes = element.className.split(\" \").filter(p => p && p !== cls);\r\n    element.className = classes.join(\" \");\r\n  }\r\n};\r\n\r\nexport const debounce = (fn, delay, immediate) => {\r\n  let timer = null;\r\n  return (...params) => {\r\n    if (timer) {\r\n      clearTimeout(timer);\r\n    }\r\n    if (immediate && !timer) {\r\n      fn.call(this, ...params);\r\n    } else {\r\n      timer = setTimeout(() => {\r\n        timer = null;\r\n        fn.call(this, ...params);\r\n      }, delay);\r\n    }\r\n  };\r\n};\r\n\r\nexport const removeChildAt = (parent, index) => {\r\n  return parent.removeChild(parent.children[index]);\r\n};\r\n\r\nexport const addChildAt = (parent, child, index) => {\r\n  if (index >= parent.children.lenght) {\r\n    parent.appendChild(child);\r\n  } else {\r\n    parent.insertBefore(child, parent.children[index]);\r\n  }\r\n};\r\n\r\nexport const isMobile = () => {\r\n  if (typeof window !== 'undefined') {\r\n    if (\r\n      global.navigator.userAgent.match(/Android/i) ||\r\n      global.navigator.userAgent.match(/webOS/i) ||\r\n      global.navigator.userAgent.match(/iPhone/i) ||\r\n      global.navigator.userAgent.match(/iPad/i) ||\r\n      global.navigator.userAgent.match(/iPod/i) ||\r\n      global.navigator.userAgent.match(/BlackBerry/i) ||\r\n      global.navigator.userAgent.match(/Windows Phone/i)\r\n    ) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const clearSelection = () => {\r\n  if (global.getSelection) {\r\n    if (global.getSelection().empty) {\r\n      // Chrome\r\n      global.getSelection().empty();\r\n    } else if (global.getSelection().removeAllRanges) {\r\n      // Firefox\r\n      global.getSelection().removeAllRanges();\r\n    }\r\n  } else if (global.document.selection) {\r\n    // IE?\r\n    global.document.selection.empty();\r\n  }\r\n};\r\n","export const containerInstance = 'smooth-dnd-container-instance';\r\nexport const containersInDraggable = 'smooth-dnd-containers-in-draggable';\r\n\r\nexport const defaultGroupName = '@@smooth-dnd-default-group@@';\r\nexport const wrapperClass = 'smooth-dnd-draggable-wrapper';\r\nexport const defaultGrabHandleClass = 'smooth-dnd-default-grap-handle';\r\nexport const animationClass = 'animated';\r\nexport const translationValue = '__smooth_dnd_draggable_translation_value';\r\nexport const visibilityValue = '__smooth_dnd_draggable_visibility_value';\r\nexport const ghostClass = 'smooth-dnd-ghost';\r\n\r\nexport const containerClass = 'smooth-dnd-container';\r\n\r\nexport const extraSizeForInsertion = 'smooth-dnd-extra-size-for-insertion';\r\nexport const stretcherElementClass = 'smooth-dnd-stretcher-element';\r\nexport const stretcherElementInstance = 'smooth-dnd-stretcher-instance';\r\n\r\nexport const isDraggableDetached = 'smoth-dnd-is-draggable-detached';\r\n\r\nexport const disbaleTouchActions = 'smooth-dnd-disable-touch-action';\r\nexport const noUserSelectClass = 'smooth-dnd-no-user-select';\r\n\r\nexport const originalTrasitionDuration = \"smooth-dnd-original-trasition-duration\";","import * as constants from './constants';\r\n\r\nconst verticalWrapperClass = {\r\n\t'overflow': 'hidden',\r\n}\r\n\r\nconst horizontalWrapperClass = {\r\n\t'height': '100%',\r\n\t'display': 'inline-block',\r\n\t'vertical-align': 'top',\r\n\t'white-space': 'normal'\r\n}\r\n\r\nconst css = {\r\n\t[`.${constants.containerClass}`]: {\r\n\t\t'position': 'relative',\r\n\t},\r\n\t[`.${constants.containerClass} *`]: {\r\n\t\t'box-sizing': 'border-box',\r\n\t},\r\n\t[`.${constants.containerClass}.horizontal`]: {\r\n\t\t'white-space': 'nowrap',\r\n\t},\r\n\t[`.${constants.containerClass}.horizontal > .${constants.wrapperClass}`]: horizontalWrapperClass,\r\n\t[`.${constants.containerClass}.vertical > .${constants.wrapperClass}`]: verticalWrapperClass,\r\n\t[`.${constants.wrapperClass}`]: {\r\n\t\t// 'overflow': 'hidden'\r\n\t},\r\n\t[`.${constants.wrapperClass}.horizontal`]: horizontalWrapperClass, \r\n\t[`.${constants.wrapperClass}.vertical`]: verticalWrapperClass, \r\n\t[`.${constants.wrapperClass}.animated`]: {\r\n\t\t'transition': 'transform ease'\r\n\t},\r\n\t[`.${constants.ghostClass} *`]: {\r\n\t\t//'perspective': '800px',\r\n\t\t'box-sizing': 'border-box',\r\n\t},\r\n\t[`.${constants.ghostClass}.animated`]: {\r\n\t\t'transition': 'all ease-in-out'\r\n\t},\r\n\t[`.${constants.disbaleTouchActions} *`]: {\r\n\t\t'touch-actions': 'none',\r\n\t\t'-ms-touch-actions': 'none'\r\n\t},\r\n\t[`.${constants.noUserSelectClass} *`]: {\r\n\t\t'-webkit-touch-callout': 'none',\r\n\t\t'-webkit-user-select': 'none',\r\n\t\t'-khtml-user-select': 'none',\r\n\t\t'-moz-user-select': 'none',\r\n\t\t'-ms-user-select': 'none',\r\n\t\t'user-select': 'none'\r\n\t}\r\n};\r\n\r\nfunction convertToCssString(css) {\r\n\treturn Object.keys(css).reduce((styleString, propName) => {\r\n\t\tconst propValue = css[propName];\r\n\t\tif (typeof (propValue) === 'object') {\r\n\t\t\treturn `${styleString}${propName}{${convertToCssString(propValue)}}`;\r\n\t\t}\r\n\t\treturn `${styleString}${propName}:${propValue};`;\r\n\t}, '');\r\n}\r\n\r\nfunction addStyleToHead() {\r\n\tif (typeof (window) !== 'undefined') {\r\n\t\tconst head = global.document.head || global.document.getElementsByTagName(\"head\")[0];\r\n\t\tconst style = global.document.createElement(\"style\");\r\n\t\tconst cssString = convertToCssString(css);\r\n\t\tstyle.type = 'text/css';\r\n\t\tif (style.styleSheet) {\r\n\t\t\tstyle.styleSheet.cssText = cssString;\r\n\t\t} else {\r\n\t\t\tstyle.appendChild(global.document.createTextNode(cssString));\r\n\t\t}\r\n\r\n\t\thead.appendChild(style);\r\n\t}\r\n}\r\n\r\nexport {\r\n\taddStyleToHead\r\n};","import { isScrolling, getScrollingAxis, getVisibleRect, debounce } from './utils';\r\n\r\nconst maxSpeed = 1500; // px/s\r\nconst minSpeed = 20; // px/s\r\n\r\nfunction addScrollValue(element, axis, value) {\r\n\tif (element) {\r\n\t\tif (element !== window) {\r\n\t\t\tif (axis === 'x') {\r\n\t\t\t\telement.scrollLeft += value;\r\n\t\t\t} else {\r\n\t\t\t\telement.scrollTop += value;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (axis === 'x') {\r\n\t\t\t\telement.scrollBy(value, 0);\r\n\t\t\t} else {\r\n\t\t\t\telement.scrollBy(0, value);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst createAnimator = (element, axis = 'y') => {\r\n\tlet isAnimating = false;\r\n\tlet request = null;\r\n\tlet startTime = null;\r\n\tlet direction = null;\r\n\tlet speed = null;\r\n\r\n\tfunction animate(_direction, _speed) {\r\n\t\tdirection = _direction;\r\n\t\tspeed = _speed;\r\n\t\tisAnimating = true;\r\n\t\tif (isAnimating) {\r\n\t\t\tstart();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction start() {\r\n\t\tif (request === null) {\r\n\t\t\trequest = requestAnimationFrame((timestamp) => {\r\n\t\t\t\tif (startTime === null) { startTime = timestamp; }\r\n\t\t\t\tconst timeDiff = timestamp - startTime;\r\n\t\t\t\tstartTime = timestamp;\r\n\t\t\t\tlet distanceDiff = (timeDiff / 1000) * speed;\r\n\t\t\t\tdistanceDiff = direction === 'begin' ? (0 - distanceDiff) : distanceDiff;\r\n\t\t\t\taddScrollValue(element, axis, distanceDiff);\r\n\t\t\t\trequest = null;\r\n\t\t\t\tstart();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction stop() {\r\n\t\tif (isAnimating) {\r\n\t\t\tcancelAnimationFrame(request);\r\n\t\t\tisAnimating = false;\r\n\t\t\tstartTime = null;\r\n\t\t\trequest = null;\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tanimate,\r\n\t\tstop\r\n\t};\r\n}\r\n\r\nfunction getAutoScrollInfo(position, scrollableInfo) {\r\n\tconst { left, right, top, bottom } = scrollableInfo.rect;\r\n\tconst { x, y } = position;\r\n\tif (x < left || x > right || y < top || y > bottom) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tlet begin;\r\n\tlet end;\r\n\tlet pos;\r\n\tif (scrollableInfo.axis === 'x') {\r\n\t\tbegin = left;\r\n\t\tend = right;\r\n\t\tpos = x;\r\n\t} else {\r\n\t\tbegin = top;\r\n\t\tend = bottom;\r\n\t\tpos = y;\r\n\t}\r\n\r\n\tconst moveDistance = 100;\r\n\tif (end - pos < moveDistance) {\r\n\t\treturn {\r\n\t\t\tdirection: 'end',\r\n\t\t\tspeedFactor: (moveDistance - (end - pos)) / moveDistance\r\n\t\t};\r\n\t} else if (pos - begin < moveDistance) {\r\n\t\t// console.log(pos - begin);\r\n\t\treturn {\r\n\t\t\tdirection: 'begin',\r\n\t\t\tspeedFactor: (moveDistance - (pos - begin)) / moveDistance\r\n\t\t};\r\n\t}\r\n}\r\n\r\nfunction scrollableInfo(element) {\r\n\tvar result = {\r\n\t\telement,\r\n\t\trect: getVisibleRect(element, element.getBoundingClientRect()),\r\n\t\tdescendants: [],\r\n\t\tinvalidate,\r\n\t\taxis: null,\r\n\t\tdispose\r\n\t};\r\n\r\n\tfunction dispose() {\r\n\t\telement.removeEventListener('scroll', invalidate);\r\n\t}\r\n\r\n\tfunction invalidate() {\r\n\t\tresult.rect = getVisibleRect(element, element.getBoundingClientRect());\r\n\t\tresult.descendants.forEach(p => p.invalidate());\r\n\t}\r\n\r\n\telement.addEventListener('scroll', invalidate);\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction getScrollableElements(containerElements) {\r\n\tconst scrollables = [];\r\n\tlet firstDescendentScrollable = null;\r\n\tcontainerElements.forEach(el => {\r\n\t\tlet current = el;\r\n\t\tfirstDescendentScrollable = null;\r\n\t\twhile (current) {\r\n\t\t\tconst scrollingAxis = getScrollingAxis(current);\r\n\t\t\tif (scrollingAxis) {\r\n\t\t\t\tif (!scrollables.some(p => p.element === current)) {\r\n\t\t\t\t\tconst info = scrollableInfo(current);\r\n\t\t\t\t\tif (firstDescendentScrollable) {\r\n\t\t\t\t\t\tinfo.descendants.push(firstDescendentScrollable);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfirstDescendentScrollable = info;\r\n\t\t\t\t\tif (scrollingAxis === 'xy') {\r\n\t\t\t\t\t\tscrollables.push(Object.assign({}, info, { axis: 'x' }));\r\n\t\t\t\t\t\tscrollables.push(Object.assign({}, info, { axis: 'y' }, { descendants: [] }));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tscrollables.push(Object.assign({}, info, { axis: scrollingAxis }));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcurrent = current.parentElement;\r\n\t\t}\r\n\t});\r\n\treturn scrollables;\r\n}\r\n\r\nfunction getScrollableAnimator(scrollableInfo) {\r\n\treturn Object.assign(scrollableInfo, createAnimator(scrollableInfo.element, scrollableInfo.axis));\r\n}\r\n\r\nfunction getWindowAnimators() {\r\n\tfunction getWindowRect() {\r\n\t\treturn {\r\n\t\t\tleft: 0, right: global.innerWidth, top: 0, bottom: global.innerHeight\r\n\t\t}\r\n\t}\r\n\r\n\treturn [\r\n\t\tObject.assign({ rect: getWindowRect(), axis: 'y' }, createAnimator(global)),\r\n\t\tObject.assign({ rect: getWindowRect(), axis: 'x' }, createAnimator(global, 'x'))\r\n\t]\r\n}\r\n\r\nexport default (containers) => {\r\n\tconst scrollablesInfo = getScrollableElements(containers.map(p => p.element));\r\n\tconst animators = [...scrollablesInfo.map(getScrollableAnimator), ...getWindowAnimators()];\r\n\treturn ({ draggableInfo, reset }) => {\r\n\t\tif (animators.length) {\r\n\t\t\tif (reset) {\r\n\t\t\t\tanimators.forEach(p => p.stop());\r\n\t\t\t\tscrollablesInfo.forEach(p => p.dispose());\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tanimators.forEach(animator => {\r\n\t\t\t\tconst scrollParams = getAutoScrollInfo(draggableInfo.mousePosition, animator);\r\n\t\t\t\tif (scrollParams) {\r\n\t\t\t\t\tanimator.animate(scrollParams.direction, scrollParams.speedFactor * maxSpeed);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tanimator.stop();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}","import './polyfills';\r\nimport * as Utils from './utils';\r\nimport * as constants from './constants';\r\nimport { addStyleToHead } from './styles';\r\nimport dragScroller from './dragscroller';\r\n\r\nconst grabEvents = ['mousedown', 'touchstart'];\r\nconst moveEvents = ['mousemove', 'touchmove'];\r\nconst releaseEvents = ['mouseup', 'touchend'];\r\n\r\nlet dragListeningContainers = null;\r\nlet grabbedElement = null;\r\nlet ghostInfo = null;\r\nlet draggableInfo = null;\r\nlet containers = [];\r\nlet isDragging = false;\r\nlet removedElement = null;\r\n\r\nlet handleDrag = null;\r\nlet handleScroll = null;\r\nlet sourceContainer = null;\r\nlet sourceContainerLockAxis = null;\r\n\r\n\r\nconst isMobile = Utils.isMobile();\r\n\r\nfunction listenEvents(listen = true) {\r\n  if (typeof window !== 'undefined') {\r\n    if (listen) {\r\n      addGrabListeners();\r\n    } else {\r\n      removeGrabListeners();\r\n    }\r\n  }\r\n}\r\n\r\nfunction addGrabListeners() {\r\n  grabEvents.forEach(e => {\r\n    global.document.addEventListener(e, onMouseDown, { passive: false });\r\n  });\r\n}\r\n\r\nfunction removeGrabListeners() {\r\n  grabEvents.forEach(e => {\r\n    global.document.removeEventListener(e, onMouseDown, { passive: false });\r\n  });\r\n}\r\n\r\nfunction addMoveListeners() {\r\n  moveEvents.forEach(e => {\r\n    global.document.addEventListener(e, onMouseMove, { passive: false });\r\n  });\r\n}\r\n\r\nfunction removeMoveListeners() {\r\n  moveEvents.forEach(e => {\r\n    global.document.removeEventListener(e, onMouseMove, { passive: false });\r\n  });\r\n}\r\n\r\nfunction addReleaseListeners() {\r\n  releaseEvents.forEach(e => {\r\n    global.document.addEventListener(e, onMouseUp, { passive: false });\r\n  });\r\n}\r\n\r\nfunction removeReleaseListeners() {\r\n  releaseEvents.forEach(e => {\r\n    global.document.removeEventListener(e, onMouseUp, { passive: false });\r\n  });\r\n}\r\n\r\nfunction getGhostParent() {\r\n  if (grabbedElement) {\r\n    return grabbedElement.parentElement || global.document.body;\r\n  } else {\r\n    return global.document.body;\r\n  }\r\n}\r\n\r\nfunction getGhostElement(wrapperElement, { x, y }, container, cursor) {\r\n  const { scaleX = 1, scaleY = 1 } = container.getScale();\r\n  const { left, top, right, bottom } = wrapperElement.getBoundingClientRect();\r\n  const midX = left + (right - left) / 2;\r\n  const midY = top + (bottom - top) / 2;\r\n  const ghost = wrapperElement.cloneNode(true);\r\n  ghost.style.zIndex = 1000;\r\n  ghost.style.boxSizing = 'border-box';\r\n  ghost.style.position = 'fixed';\r\n  ghost.style.left = left + 'px';\r\n  ghost.style.top = top + 'px';\r\n  ghost.style.width = right - left + 'px';\r\n  ghost.style.height = bottom - top + 'px';\r\n  ghost.style.overflow = 'visible';\r\n  ghost.style.transition = null;\r\n  ghost.style.removeProperty('transition');\r\n  ghost.style.pointerEvents = 'none';\r\n  // ghost.style.cursor = cursor;\r\n  setTimeout(() => {\r\n    if (container.getOptions().dragClass) {\r\n      Utils.addClass(ghost.firstElementChild, container.getOptions().dragClass);\r\n    }\r\n  });\r\n  Utils.addClass(ghost, container.getOptions().orientation);\r\n  Utils.addClass(ghost, constants.ghostClass);\r\n\r\n  return {\r\n    ghost: ghost,\r\n    centerDelta: { x: midX - x, y: midY - y },\r\n    positionDelta: { left: left - x, top: top - y }\r\n  };\r\n}\r\n\r\nfunction getDraggableInfo(draggableElement) {\r\n  const container = containers.filter(p => draggableElement.parentElement === p.element)[0];\r\n  const draggableIndex = container.draggables.indexOf(draggableElement);\r\n  return {\r\n    container,\r\n    element: draggableElement,\r\n    elementIndex: draggableIndex,\r\n    payload: container.getOptions().getChildPayload\r\n      ? container.getOptions().getChildPayload(draggableIndex)\r\n      : undefined,\r\n    targetElement: null,\r\n    position: { x: 0, y: 0 },\r\n    groupName: container.getOptions().groupName\r\n  };\r\n}\r\n\r\nfunction handleDropAnimation(callback) {\r\n  function endDrop() {\r\n    Utils.removeClass(ghostInfo.ghost, 'animated');\r\n    ghostInfo.ghost.style.transitionDuration = null;\r\n    getGhostParent().removeChild(ghostInfo.ghost);\r\n    callback();\r\n  }\r\n\r\n  function animateGhostToPosition({ top, left }, duration, dropClass) {\r\n    Utils.addClass(ghostInfo.ghost, 'animated');\r\n    if (dropClass) {\r\n      Utils.addClass(ghostInfo.ghost.firstElementChild, dropClass);\r\n    }\r\n    ghostInfo.ghost.style.transitionDuration = duration + 'ms';\r\n    ghostInfo.ghost.style.left = left + 'px';\r\n    ghostInfo.ghost.style.top = top + 'px';\r\n    setTimeout(function() {\r\n      endDrop();\r\n    }, duration + 20);\r\n  }\r\n\r\n  function shouldAnimateDrop(options) {\r\n    return options.shouldAnimateDrop\r\n      ? options.shouldAnimateDrop(draggableInfo.container.getOptions(), draggableInfo.payload)\r\n      : true;\r\n  }\r\n\r\n  if (draggableInfo.targetElement) {\r\n    const container = containers.filter(p => p.element === draggableInfo.targetElement)[0];\r\n    if (shouldAnimateDrop(container.getOptions())) {\r\n      const dragResult = container.getDragResult();\r\n      animateGhostToPosition(\r\n        dragResult.shadowBeginEnd.rect,\r\n        Math.max(150, container.getOptions().animationDuration / 2),\r\n        container.getOptions().dropClass\r\n      );\r\n    } else {\r\n      endDrop();\r\n    }\r\n  } else {\r\n    const container = containers.filter(p => p === draggableInfo.container)[0];\r\n    if (container.getOptions().behaviour === 'move' && container.getDragResult()) {\r\n      const { removedIndex, elementSize } = container.getDragResult();\r\n      const layout = container.layout;\r\n      // drag ghost to back\r\n      container.getTranslateCalculator({\r\n        dragResult: {\r\n          removedIndex,\r\n          addedIndex: removedIndex,\r\n          elementSize\r\n        }\r\n      });\r\n      const prevDraggableEnd =\r\n        removedIndex > 0\r\n          ? layout.getBeginEnd(container.draggables[removedIndex - 1]).end\r\n          : layout.getBeginEndOfContainer().begin;\r\n      animateGhostToPosition(\r\n        layout.getTopLeftOfElementBegin(prevDraggableEnd),\r\n        container.getOptions().animationDuration,\r\n        container.getOptions().dropClass\r\n      );\r\n    } else {\r\n      Utils.addClass(ghostInfo.ghost, 'animated');\r\n      ghostInfo.ghost.style.transitionDuration = container.getOptions().animationDuration + 'ms';\r\n      ghostInfo.ghost.style.opacity = '0';\r\n      ghostInfo.ghost.style.transform = 'scale(0.90)';\r\n      setTimeout(function() {\r\n        endDrop();\r\n      }, container.getOptions().animationDuration);\r\n    }\r\n  }\r\n}\r\n\r\nconst handleDragStartConditions = (function handleDragStartConditions() {\r\n  let startEvent;\r\n  let delay;\r\n  let clb;\r\n  let timer = null;\r\n  const moveThreshold = 1;\r\n  const maxMoveInDelay = 5;\r\n\r\n  function onMove(event) {\r\n    const { clientX: currentX, clientY: currentY } = getPointerEvent(event);\r\n    if (!delay) {\r\n      if (\r\n        Math.abs(startEvent.clientX - currentX) > moveThreshold ||\r\n        Math.abs(startEvent.clientY - currentY) > moveThreshold\r\n      ) {\r\n        return callCallback();\r\n      }\r\n    } else {\r\n      if (\r\n        Math.abs(startEvent.clientX - currentX) > maxMoveInDelay ||\r\n        Math.abs(startEvent.clientY - currentY) > maxMoveInDelay\r\n      ) {\r\n        deregisterEvent();\r\n      }\r\n    }\r\n  }\r\n\r\n  function onUp() {\r\n    deregisterEvent();\r\n  }\r\n  function onHTMLDrag() {\r\n    deregisterEvent();\r\n  }\r\n\r\n  function registerEvents() {\r\n    if (delay) {\r\n      timer = setTimeout(callCallback, delay);\r\n    }\r\n\r\n    moveEvents.forEach(e => global.document.addEventListener(e, onMove), {\r\n      passive: false\r\n    });\r\n    releaseEvents.forEach(e => global.document.addEventListener(e, onUp), {\r\n      passive: false\r\n    });\r\n    global.document.addEventListener('drag', onHTMLDrag, {\r\n      passive: false\r\n    });\r\n  }\r\n\r\n  function deregisterEvent() {\r\n    clearTimeout(timer);\r\n    moveEvents.forEach(e => global.document.removeEventListener(e, onMove), {\r\n      passive: false\r\n    });\r\n    releaseEvents.forEach(e => global.document.removeEventListener(e, onUp), {\r\n      passive: false\r\n    });\r\n    global.document.removeEventListener('drag', onHTMLDrag, {\r\n      passive: false\r\n    });\r\n  }\r\n\r\n  function callCallback() {\r\n    clearTimeout(timer);\r\n    deregisterEvent();\r\n    clb();\r\n  }\r\n\r\n  return function(_startEvent, _delay, _clb) {\r\n    startEvent = getPointerEvent(_startEvent);\r\n    delay = (typeof _delay === 'number') ? _delay : (isMobile ? 200 : 0);\r\n    clb = _clb;\r\n\r\n    registerEvents();\r\n  };\r\n})();\r\n\r\nfunction onMouseDown(event) {\r\n  const e = getPointerEvent(event);\r\n  if (!isDragging && (e.button === undefined || e.button === 0)) {\r\n    grabbedElement = Utils.getParent(e.target, '.' + constants.wrapperClass);\r\n    if (grabbedElement) {\r\n      const containerElement = Utils.getParent(grabbedElement, '.' + constants.containerClass);\r\n      const container = containers.filter(p => p.element === containerElement)[0];\r\n      const dragHandleSelector = container.getOptions().dragHandleSelector;\r\n      const nonDragAreaSelector = container.getOptions().nonDragAreaSelector;\r\n\r\n      let startDrag = true;\r\n      if (dragHandleSelector && !Utils.getParent(e.target, dragHandleSelector)) {\r\n        startDrag = false;\r\n      }\r\n\r\n      if (nonDragAreaSelector && Utils.getParent(e.target, nonDragAreaSelector)) {\r\n        startDrag = false;\r\n      }\r\n\r\n      if (startDrag) {\r\n        handleDragStartConditions(e, container.getOptions().dragBeginDelay, () => {\r\n          Utils.clearSelection();\r\n          initiateDrag(e);\r\n          addMoveListeners();\r\n          addReleaseListeners();\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction onMouseUp() {\r\n  removeMoveListeners();\r\n  removeReleaseListeners();\r\n  handleScroll({ reset: true });\r\n  if (draggableInfo) {\r\n    handleDropAnimation(() => {\r\n      Utils.removeClass(global.document.body, constants.disbaleTouchActions);\r\n      Utils.removeClass(global.document.body, constants.noUserSelectClass);\r\n      fireOnDragStartEnd(false);\r\n      (dragListeningContainers || []).forEach(p => {\r\n        p.handleDrop(draggableInfo);\r\n      });\r\n\r\n      dragListeningContainers = null;\r\n      grabbedElement = null;\r\n      ghostInfo = null;\r\n      draggableInfo = null;\r\n      isDragging = false;\r\n      sourceContainer = null;\r\n      sourceContainerLockAxis = null;\r\n      handleDrag = null;\r\n    });\r\n  }\r\n}\r\n\r\nfunction getPointerEvent(e) {\r\n  return e.touches ? e.touches[0] : e;\r\n}\r\n\r\nfunction dragHandler(dragListeningContainers) {\r\n  let targetContainers = dragListeningContainers;\r\n  return function(draggableInfo) {\r\n    let containerBoxChanged = false;\r\n    targetContainers.forEach(p => {\r\n      const dragResult = p.handleDrag(draggableInfo);\r\n      containerBoxChanged |= dragResult.containerBoxChanged || false;\r\n      dragResult.containerBoxChanged = false;\r\n    });\r\n    handleScroll({ draggableInfo });\r\n\r\n    if (containerBoxChanged) {\r\n      containerBoxChanged = false;\r\n      setTimeout(() => {\r\n\t\t\t\tcontainers.forEach(p => {\r\n\t\t\t\t\tp.layout.invalidateRects();\r\n\t\t\t\t\tp.onTranslated();\r\n\t\t\t\t});\r\n      }, 10);\r\n    }\r\n  };\r\n}\r\n\r\nfunction getScrollHandler(container, dragListeningContainers) {\r\n  if (container.getOptions().autoScrollEnabled) {\r\n    return dragScroller(dragListeningContainers);\r\n  } else {\r\n    return () => null;\r\n  }\r\n}\r\n\r\nfunction fireOnDragStartEnd(isStart) {\r\n  containers.forEach(p => {\r\n    const fn = isStart ? p.getOptions().onDragStart : p.getOptions().onDragEnd;\r\n    if (fn) {\r\n      const options = {\r\n        isSource: p === draggableInfo.container,\r\n        payload: draggableInfo.payload\r\n      };\r\n      if (p.isDragRelevant(draggableInfo.container, draggableInfo.payload)) {\r\n        options.willAcceptDrop = true;\r\n      } else {\r\n        options.willAcceptDrop = false;\r\n      }\r\n      fn(options);\r\n    }\r\n  });\r\n}\r\n\r\nfunction initiateDrag(position, cursor) {\r\n  isDragging = true;\r\n  const container = containers.filter(p => grabbedElement.parentElement === p.element)[0];\r\n  container.setDraggables();\r\n  sourceContainer = container;\r\n  sourceContainerLockAxis = container.getOptions().lockAxis ? container.getOptions().lockAxis.toLowerCase() : null;\r\n\r\n  draggableInfo = getDraggableInfo(grabbedElement);\r\n  ghostInfo = getGhostElement(\r\n    grabbedElement,\r\n    { x: position.clientX, y: position.clientY },\r\n    draggableInfo.container,\r\n    cursor\r\n  );\r\n  draggableInfo.position = {\r\n    x: position.clientX + ghostInfo.centerDelta.x,\r\n    y: position.clientY + ghostInfo.centerDelta.y\r\n  };\r\n  draggableInfo.mousePosition = {\r\n    x: position.clientX,\r\n    y: position.clientY\r\n  };\r\n\r\n  Utils.addClass(global.document.body, constants.disbaleTouchActions);\r\n  Utils.addClass(global.document.body, constants.noUserSelectClass);\r\n\r\n  dragListeningContainers = containers.filter(p => p.isDragRelevant(container, draggableInfo.payload));\r\n  handleDrag = dragHandler(dragListeningContainers);\r\n  if (handleScroll) {\r\n    handleScroll({ reset: true });\r\n  }\r\n  handleScroll = getScrollHandler(container, dragListeningContainers);\r\n  dragListeningContainers.forEach(p => p.prepareDrag(p, dragListeningContainers));\r\n  fireOnDragStartEnd(true);\r\n  handleDrag(draggableInfo);\r\n  getGhostParent().appendChild(ghostInfo.ghost);\r\n}\r\n\r\nfunction onMouseMove(event) {\r\n  event.preventDefault();\r\n  const e = getPointerEvent(event);\r\n  if (!draggableInfo) {\r\n    initiateDrag(e);\r\n  } else {\r\n    // just update ghost position && draggableInfo position\r\n    if (sourceContainerLockAxis) {\r\n      if (sourceContainerLockAxis === 'y') {\r\n        ghostInfo.ghost.style.top = `${e.clientY + ghostInfo.positionDelta.top}px`;\r\n        draggableInfo.position.y = e.clientY + ghostInfo.centerDelta.y;\r\n        draggableInfo.mousePosition.y = e.clientY;\r\n      } else if (sourceContainerLockAxis === 'x') {\r\n        ghostInfo.ghost.style.left = `${e.clientX + ghostInfo.positionDelta.left}px`;\r\n        draggableInfo.position.x = e.clientX + ghostInfo.centerDelta.x;\r\n        draggableInfo.mousePosition.x = e.clientX;\r\n      }\r\n    } else {\r\n      ghostInfo.ghost.style.left = `${e.clientX + ghostInfo.positionDelta.left}px`;\r\n      ghostInfo.ghost.style.top = `${e.clientY + ghostInfo.positionDelta.top}px`;\r\n      draggableInfo.position.x = e.clientX + ghostInfo.centerDelta.x;\r\n      draggableInfo.position.y = e.clientY + ghostInfo.centerDelta.y;\r\n      draggableInfo.mousePosition.x = e.clientX;\r\n      draggableInfo.mousePosition.y = e.clientY;\r\n    }\r\n\r\n    handleDrag(draggableInfo);\r\n  }\r\n}\r\n\r\nfunction Mediator() {\r\n  return {\r\n    register: function(container) {\r\n      containers.push(container);\r\n      if (containers.length === 1) {\r\n        listenEvents();        \r\n      }\r\n    },\r\n    unregister: function(container) {\r\n      containers.splice(containers.indexOf(container), 1);\r\n      if (containers.length === 0) {\r\n        listenEvents(false);        \r\n      }\r\n    }\r\n  };\r\n}\r\n\r\naddStyleToHead();\r\n\r\nexport default Mediator();\r\n","import * as Utils from './utils';\r\nimport { translationValue, visibilityValue, extraSizeForInsertion, containersInDraggable } from './constants';\r\n\r\n\r\n\r\nconst horizontalMap = {\r\n\tsize: 'offsetWidth',\r\n\tdistanceToParent: 'offsetLeft',\r\n\ttranslate: 'transform',\r\n\tbegin: 'left',\r\n\tend: 'right',\r\n\tdragPosition: 'x',\r\n\tscrollSize: 'scrollWidth',\r\n\toffsetSize: 'offsetWidth',\r\n\tscrollValue: 'scrollLeft',\r\n\tscale: 'scaleX',\r\n\tsetSize: 'width',\r\n\tsetters: {\r\n\t\t'translate': (val) => `translate3d(${val}px, 0, 0)`\r\n\t}\r\n};\r\n\r\nconst verticalMap = {\r\n\tsize: 'offsetHeight',\r\n\tdistanceToParent: 'offsetTop',\r\n\ttranslate: 'transform',\r\n\tbegin: 'top',\r\n\tend: 'bottom',\r\n\tdragPosition: 'y',\r\n\tscrollSize: 'scrollHeight',\r\n\toffsetSize: 'offsetHeight',\r\n\tscrollValue: 'scrollTop',\r\n\tscale: 'scaleY',\r\n\tsetSize: 'height',\r\n\tsetters: {\r\n\t\t'translate': (val) => `translate3d(0,${val}px, 0)`\r\n\t}\r\n};\r\n\r\nfunction orientationDependentProps(map) {\r\n\tfunction get(obj, prop) {\r\n\t\tconst mappedProp = map[prop];\r\n\t\treturn obj[mappedProp || prop];\r\n\t}\r\n\r\n\tfunction set(obj, prop, value) {\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\tobj[map[prop]] = map.setters[prop] ? map.setters[prop](value) : value;\r\n\t\t});\r\n\t}\r\n\r\n\treturn { get, set };\r\n}\r\n\r\nexport default function layoutManager(containerElement, orientation, _animationDuration) {\r\n\tcontainerElement[extraSizeForInsertion] = 0;\r\n\tconst animationDuration = _animationDuration;\r\n\tconst map = orientation === 'horizontal' ? horizontalMap : verticalMap;\r\n\tconst propMapper = orientationDependentProps(map);\r\n\tconst values = {\r\n\t\ttranslation: 0\r\n\t};\r\n\tlet registeredScrollListener = null;\r\n\r\n\tglobal.addEventListener('resize', function() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t\t// invalidateContainerScale(containerElement);\r\n\t});\r\n\r\n\tsetTimeout(() => {\r\n\t\tinvalidate();\r\n\t}, 10);\r\n\t// invalidate();\r\n\r\n\tconst scrollListener = Utils.listenScrollParent(containerElement, function() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t\tregisteredScrollListener && registeredScrollListener();\r\n\t});\r\n\tfunction invalidate() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t\tinvalidateContainerScale(containerElement);\r\n\t}\r\n\r\n\tlet visibleRect;\r\n\tfunction invalidateContainerRectangles(containerElement) {\r\n\t\tvalues.rect = Utils.getContainerRect(containerElement);\r\n\t\tvalues.visibleRect = Utils.getVisibleRect(containerElement, values.rect);\r\n\t}\r\n\r\n\tfunction invalidateContainerScale(containerElement) {\r\n\t\tconst rect = containerElement.getBoundingClientRect();\r\n\t\tvalues.scaleX = containerElement.offsetWidth ? ((rect.right - rect.left) / containerElement.offsetWidth) : 1;\r\n\t\tvalues.scaleY = containerElement.offsetHeight ? ((rect.bottom - rect.top) / containerElement.offsetHeight) : 1;\r\n\t}\r\n\r\n\tfunction getContainerRectangles() {\r\n\t\treturn {\r\n\t\t\trect: values.rect,\r\n\t\t\tvisibleRect: values.visibleRect\r\n\t\t};\r\n\t}\r\n\r\n\tfunction getBeginEndOfDOMRect(rect) {\r\n\t\treturn {\r\n\t\t\tbegin: propMapper.get(rect, 'begin'),\r\n\t\t\tend: propMapper.get(rect, 'end')\r\n\t\t};\r\n\t}\r\n\r\n\tfunction getBeginEndOfContainer() {\r\n\t\tconst begin = propMapper.get(values.rect, 'begin') + values.translation;\r\n\t\tconst end = propMapper.get(values.rect, 'end') + values.translation;\r\n\t\treturn { begin, end };\r\n\t}\r\n\r\n\tfunction getBeginEndOfContainerVisibleRect() {\r\n\t\tconst begin = propMapper.get(values.visibleRect, 'begin') + values.translation;\r\n\t\tconst end = propMapper.get(values.visibleRect, 'end') + values.translation;\r\n\t\treturn { begin, end };\r\n\t}\r\n\r\n\tfunction getContainerScale() {\r\n\t\treturn { scaleX: values.scaleX, scaleY: values.scaleY };\r\n\t}\r\n\r\n\tfunction getSize(element) {\r\n\t\treturn propMapper.get(element, 'size') * propMapper.get(values, 'scale');\r\n\t}\r\n\r\n\tfunction getDistanceToOffsetParent(element) {\r\n\t\tconst distance = propMapper.get(element, 'distanceToParent') + (element[translationValue] || 0);\r\n\t\treturn distance * propMapper.get(values, 'scale');\r\n\t}\r\n\r\n\tfunction getBeginEnd(element) {\r\n\t\tconst begin = getDistanceToOffsetParent(element) + (propMapper.get(values.rect, 'begin') + values.translation) - propMapper.get(containerElement, 'scrollValue');\r\n\t\treturn {\r\n\t\t\tbegin,\r\n\t\t\tend: begin + getSize(element) * propMapper.get(values, 'scale')\r\n\t\t};\r\n\t}\r\n\r\n\tfunction setSize(element, size) {\r\n\t\tpropMapper.set(element, 'setSize', size);\r\n\t}\r\n\r\n\tfunction getAxisValue(position) {\r\n\t\treturn propMapper.get(position, 'dragPosition');\r\n\t}\r\n\r\n\tfunction updateDescendantContainerRects(container) {\r\n\t\tcontainer.layout.invalidateRects();\r\n\t\tcontainer.onTranslated();\r\n\t\tif (container.getChildContainers()) {\r\n\t\t\tcontainer.getChildContainers().forEach(p => updateDescendantContainerRects(p));\r\n\t\t}\r\n\t}\r\n\r\n\tfunction setTranslation(element, translation) {\r\n\t\tif (!translation) {\r\n\t\t\telement.style.removeProperty('transform');\r\n\t\t} else {\r\n\t\t\tpropMapper.set(element.style, 'translate', translation);\r\n\t\t}\r\n\t\telement[translationValue] = translation;\r\n\r\n\t\tif (element[containersInDraggable]) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\telement[containersInDraggable].forEach(p => {\r\n\t\t\t\t\tupdateDescendantContainerRects(p);\r\n\t\t\t\t});\r\n\t\t\t}, animationDuration + 20);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getTranslation(element) {\r\n\t\treturn element[translationValue];\r\n\t}\r\n\r\n\tfunction setVisibility(element, isVisible) {\r\n\t\tif (element[visibilityValue] === undefined || element[visibilityValue] !== isVisible) {\r\n\t\t\tif (isVisible) {\r\n\t\t\t\telement.style.removeProperty('visibility');\r\n\t\t\t} else {\r\n\t\t\t\telement.style.visibility = 'hidden';\r\n\t\t\t}\r\n\t\t\telement[visibilityValue] = isVisible;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction isVisible(element) {\r\n\t\treturn element[visibilityValue] === undefined || element[visibilityValue];\r\n\t}\r\n\r\n\tfunction isInVisibleRect(x, y) {\r\n\t\tlet { left, top, right, bottom } = values.visibleRect;\r\n\r\n\t\t// if there is no wrapper in rect size will be 0 and wont accept any drop\r\n\t\t// so make sure at least there is 30px difference\r\n\t\tif (bottom - top < 2) {\r\n\t\t\tbottom = top + 30;\r\n\t\t}\r\n\t\tconst containerRect = values.rect;\r\n\t\tif (orientation === 'vertical') {\r\n\t\t\treturn x > containerRect.left && x < containerRect.right && y > top && y < bottom;\r\n\t\t} else {\r\n\t\t\treturn x > left && x < right && y > containerRect.top && y < containerRect.bottom;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction setScrollListener(callback) {\r\n\t\tregisteredScrollListener = callback;\r\n\t}\r\n\r\n\tfunction getTopLeftOfElementBegin(begin) {\r\n\t\tlet top = 0;\r\n\t\tlet left = 0;\r\n\t\tif (orientation === 'horizontal') {\r\n\t\t\tleft = begin;\r\n\t\t\ttop = values.rect.top;\r\n\t\t} else {\r\n\t\t\tleft = values.rect.left;\r\n\t\t\ttop = begin;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\ttop, left\r\n\t\t};\r\n\t}\r\n\r\n\tfunction getScrollSize(element) {\r\n\t\treturn propMapper.get(element, 'scrollSize');\r\n\t}\r\n\r\n\tfunction getScrollValue(element) {\r\n\t\treturn propMapper.get(element, 'scrollValue');\r\n\t}\r\n\r\n\tfunction setScrollValue(element, val) {\r\n\t\treturn propMapper.set(element, 'scrollValue', val);\r\n\t}\r\n\r\n\tfunction dispose() {\r\n\t\tif (scrollListener) {\r\n\t\t\tscrollListener.dispose();\r\n\t\t}\r\n\r\n\t\tif (visibleRect) {\r\n\t\t\tvisibleRect.parentNode.removeChild(visibleRect);\r\n\t\t\tvisibleRect = null;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getPosition(position) {\r\n\t\treturn isInVisibleRect(position.x, position.y) ? getAxisValue(position) : null;\r\n\t}\r\n\r\n\tfunction invalidateRects() {\r\n\t\tinvalidateContainerRectangles(containerElement);\r\n\t}\r\n\r\n\treturn {\r\n\t\tgetSize,\r\n\t\t//getDistanceToContainerBegining,\r\n\t\tgetContainerRectangles,\r\n\t\tgetBeginEndOfDOMRect,\r\n\t\tgetBeginEndOfContainer,\r\n\t\tgetBeginEndOfContainerVisibleRect,\r\n\t\tgetBeginEnd,\r\n\t\tgetAxisValue,\r\n\t\tsetTranslation,\r\n\t\tgetTranslation,\r\n\t\tsetVisibility,\r\n\t\tisVisible,\r\n\t\tisInVisibleRect,\r\n\t\tdispose,\r\n\t\tgetContainerScale,\r\n\t\tsetScrollListener,\r\n\t\tsetSize,\r\n\t\tgetTopLeftOfElementBegin,\r\n\t\tgetScrollSize,\r\n\t\tgetScrollValue,\r\n\t\tsetScrollValue,\r\n\t\tinvalidate,\r\n\t\tinvalidateRects,\r\n\t\tgetPosition,\r\n\t};\r\n}","import { addChildAt, removeChildAt } from './utils';\r\nimport {\r\n\twrapperClass,\r\n\tanimationClass,\r\n\tcontainersInDraggable\r\n} from './constants';\r\n\r\n\r\nexport function domDropHandler({ element, draggables, layout, options }) {\r\n\treturn (dropResult, onDrop) => {\r\n\t\t// const { removedIndex, addedIndex, droppedElement } = dropResult;\r\n\t\t// let removedWrapper = null;\r\n\t\t// if (removedIndex !== null) {\r\n\t\t// \tremovedWrapper = removeChildAt(element, removedIndex);\r\n\t\t// \tdraggables.splice(removedIndex, 1);\r\n\t\t// }\r\n\r\n\t\t// if (addedIndex !== null) {\r\n\t\t// \tconst wrapper = removedWrapper || droppedElement;\r\n\t\t// \twrapper[containersInDraggable] = [];\r\n\t\t// \taddChildAt(element, wrapper, addedIndex);\t\t\t\r\n\t\t// }\r\n\r\n\t\tif (onDrop) {\r\n\t\t\tonDrop(dropResult);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport function reactDropHandler() {\r\n\tconst handler = ({ element, draggables, layout, options }) => {\r\n\t\treturn (dropResult, onDrop) => {\r\n\t\t\tif (onDrop) {\r\n\t\t\t\tonDrop(dropResult);\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\treturn {\r\n\t\thandler\r\n\t};\r\n}","import Mediator from './mediator';\r\nimport layoutManager from './layoutManager';\r\nimport { hasClass, addClass, removeClass, getParent } from './utils';\r\nimport { domDropHandler } from './dropHandlers';\r\nimport {\r\n  defaultGroupName,\r\n  wrapperClass,\r\n  animationClass,\r\n  stretcherElementClass,\r\n  stretcherElementInstance,\r\n  translationValue,\r\n  containerClass,\r\n  containerInstance,\r\n  containersInDraggable,\r\n  originalTrasitionDuration\r\n} from './constants';\r\n\r\nconst defaultOptions = {\r\n  groupName: null,\r\n  behaviour: 'move', // move | copy\r\n  orientation: 'vertical', // vertical | horizontal\r\n  getChildPayload: null,\r\n  animationDuration: 250,\r\n  autoScrollEnabled: true,\r\n  shouldAcceptDrop: null,\r\n  shouldAnimateDrop: null\r\n};\r\n\r\nfunction setAnimation(element, add, animationDuration) {\r\n  if (add) {\r\n    addClass(element, animationClass);\r\n    element[originalTrasitionDuration] = element.style.getPropertyValue('transition-duration');\r\n    element.style.transitionDuration = animationDuration + 'ms';\r\n  } else {\r\n    removeClass(element, animationClass);\r\n    element.style.removeProperty('transition-duration');\r\n    if (element[originalTrasitionDuration]) {\r\n      element.style.setProperty('transition-duration', element[originalTrasitionDuration]);      \r\n      element[originalTrasitionDuration] = null;\r\n    }\r\n  }\r\n}\r\n\r\nfunction getContainer(element) {\r\n  return element ? element[containerInstance] : null;\r\n}\r\n\r\nfunction initOptions(props = defaultOptions) {\r\n  return Object.assign({}, defaultOptions, props);\r\n}\r\n\r\nfunction isDragRelevant({ element, options }) {\r\n  return function(sourceContainer, payload) {\r\n    if (options.shouldAcceptDrop) {\r\n      return options.shouldAcceptDrop(sourceContainer.getOptions(), payload);\r\n    }\r\n    const sourceOptions = sourceContainer.getOptions();\r\n    if (options.behaviour === 'copy') return false;\r\n\r\n    const parentWrapper = getParent(element, '.' + wrapperClass);\r\n    if (parentWrapper === sourceContainer.element) {\r\n      return false;\r\n    }\r\n\r\n    if (sourceContainer.element === element) return true;\r\n    if (sourceOptions.groupName && sourceOptions.groupName === options.groupName) return true;\r\n\r\n    return false;\r\n  };\r\n}\r\n\r\nfunction wrapChild(child) {\r\n  if (SmoothDnD.wrapChild) {\r\n    return SmoothDnD.wrapChild(child);\r\n  }\r\n  // const div = global.document.createElement('div');\r\n  // div.className = `${wrapperClass}`;\r\n  // child.parentElement.insertBefore(div, child);\r\n  // div.appendChild(child);\r\n  addClass(child, wrapperClass);\r\n  return child;\r\n}\r\n\r\nfunction wrapChildren(element) {\r\n  const draggables = [];\r\n  Array.prototype.map.call(element.children, child => {\r\n    if (child.nodeType === Node.ELEMENT_NODE) {\r\n      let wrapper = child;\r\n      if (!hasClass(child, wrapperClass)) {\r\n        wrapper = wrapChild(child);\r\n      }\r\n      wrapper[containersInDraggable] = [];\r\n      wrapper[translationValue] = 0;\r\n      draggables.push(wrapper);\r\n    } else {\r\n      element.removeChild(child);\r\n    }\r\n  });\r\n  return draggables;\r\n}\r\n\r\nfunction unwrapChildren(element) {\r\n  // Array.prototype.map.call(element.children, child => {\r\n  //   if (child.nodeType === Node.ELEMENT_NODE) {\r\n  //     let wrapper = child;\r\n  //     if (hasClass(child, wrapperClass)) {\r\n  //       element.insertBefore(wrapper, wrapChild.firstElementChild);\r\n  //       element.removeChild(wrapper);\r\n  //     }\r\n  //   }\r\n  // });\r\n}\r\n\r\nfunction findDraggebleAtPos({ layout }) {\r\n  const find = (draggables, pos, startIndex, endIndex, withRespectToMiddlePoints = false) => {\r\n    if (endIndex < startIndex) {\r\n      return startIndex;\r\n    }\r\n    // binary serach draggable\r\n    if (startIndex === endIndex) {\r\n      let { begin, end } = layout.getBeginEnd(draggables[startIndex]);\r\n      // mouse pos is inside draggable\r\n      // now decide which index to return\r\n      if (pos > begin && pos <= end) {\r\n        if (withRespectToMiddlePoints) {\r\n          return pos < (end + begin) / 2 ? startIndex : startIndex + 1;\r\n        } else {\r\n          return startIndex;\r\n        }\r\n      } else {\r\n        return null;\r\n      }\r\n    } else {\r\n      const middleIndex = Math.floor((endIndex + startIndex) / 2);\r\n      const { begin, end } = layout.getBeginEnd(draggables[middleIndex]);\r\n      if (pos < begin) {\r\n        return find(draggables, pos, startIndex, middleIndex - 1, withRespectToMiddlePoints);\r\n      } else if (pos > end) {\r\n        return find(draggables, pos, middleIndex + 1, endIndex, withRespectToMiddlePoints);\r\n      } else {\r\n        if (withRespectToMiddlePoints) {\r\n          return pos < (end + begin) / 2 ? middleIndex : middleIndex + 1;\r\n        } else {\r\n          return middleIndex;\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  return (draggables, pos, withRespectToMiddlePoints = false) => {\r\n    return find(draggables, pos, 0, draggables.length - 1, withRespectToMiddlePoints);\r\n  };\r\n}\r\n\r\nfunction resetDraggables({ element, draggables, layout, options }) {\r\n  return function() {\r\n    draggables.forEach(p => {\r\n      setAnimation(p, false);\r\n      layout.setTranslation(p, 0);\r\n      layout.setVisibility(p, true);\r\n      p[containersInDraggable] = [];\r\n    });\r\n\r\n    if (element[stretcherElementInstance]) {\r\n      element[stretcherElementInstance].parentNode.removeChild(element[stretcherElementInstance]);\r\n      element[stretcherElementInstance] = null;\r\n    }\r\n  };\r\n}\r\n\r\nfunction setTargetContainer(draggableInfo, element, set = true) {\r\n  if (element && set) {\r\n    draggableInfo.targetElement = element;\r\n  } else {\r\n    if (draggableInfo.targetElement === element) {\r\n      draggableInfo.targetElement = null;\r\n    }\r\n  }\r\n}\r\n\r\nfunction handleDrop({ element, draggables, layout, options }) {\r\n  const draggablesReset = resetDraggables({ element, draggables, layout, options });\r\n  const dropHandler = (SmoothDnD.dropHandler || domDropHandler)({ element, draggables, layout, options });\r\n  return function(draggableInfo, { addedIndex, removedIndex }) {\r\n    draggablesReset();\r\n    // if drop zone is valid => complete drag else do nothing everything will be reverted by draggablesReset()\r\n    if (draggableInfo.targetElement) {\r\n      let actualAddIndex =\r\n        addedIndex !== null ? (removedIndex !== null && removedIndex < addedIndex ? addedIndex - 1 : addedIndex) : null;\r\n      const dropHandlerParams = {\r\n        removedIndex,\r\n        addedIndex: actualAddIndex,\r\n        payload: draggableInfo.payload,\r\n        droppedElement: draggableInfo.element\r\n      };\r\n      dropHandler(dropHandlerParams, options.onDrop);\r\n    }\r\n  };\r\n}\r\n\r\nfunction getContainerProps(element, initialOptions) {\r\n  const options = initOptions(initialOptions);\r\n  const draggables = wrapChildren(element, options.orientation, options.animationDuration);\r\n  // set flex classes before layout is inited for scroll listener\r\n  addClass(element, `${containerClass} ${options.orientation}`);\r\n  const layout = layoutManager(element, options.orientation, options.animationDuration);\r\n  return {\r\n    element,\r\n    draggables,\r\n    options,\r\n    layout\r\n  };\r\n}\r\n\r\nfunction getRelaventParentContainer(container, relevantContainers) {\r\n  let current = container.element;\r\n  while (current) {\r\n    const containerOfParentElement = getContainer(current.parentElement);\r\n    if (containerOfParentElement && relevantContainers.indexOf(containerOfParentElement) > -1) {\r\n      return {\r\n        container: containerOfParentElement,\r\n        draggable: current\r\n      };\r\n    }\r\n    current = current.parentElement;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nfunction registerToParentContainer(container, relevantContainers) {\r\n  const parentInfo = getRelaventParentContainer(container, relevantContainers);\r\n  if (parentInfo) {\r\n    parentInfo.container.getChildContainers().push(container);\r\n    container.setParentContainer(parentInfo.container);\r\n    //current should be draggable\r\n    parentInfo.draggable[containersInDraggable].push(container);\r\n  }\r\n}\r\n\r\nfunction getRemovedItem({ draggables, element, options }) {\r\n  let prevRemovedIndex = null;\r\n  return ({ draggableInfo, dragResult }) => {\r\n    let removedIndex = prevRemovedIndex;\r\n    if (prevRemovedIndex == null && draggableInfo.container.element === element && options.behaviour !== 'copy') {\r\n      removedIndex = prevRemovedIndex = draggableInfo.elementIndex;\r\n    }\r\n\r\n    return { removedIndex };\r\n  };\r\n}\r\n\r\nfunction setRemovedItemVisibilty({ draggables, layout }) {\r\n  return ({ draggableInfo, dragResult }) => {\r\n    if (dragResult.removedIndex !== null) {\r\n      layout.setVisibility(draggables[dragResult.removedIndex], false);\r\n    }\r\n  };\r\n}\r\n\r\nfunction getPosition({ element, layout }) {\r\n  return ({ draggableInfo }) => {\r\n    return {\r\n      pos: !getContainer(element).isPosInChildContainer() ? layout.getPosition(draggableInfo.position) : null\r\n    };\r\n  };\r\n}\r\n\r\nfunction notifyParentOnPositionCapture({ element }) {\r\n  let isCaptured = false;\r\n  return ({ draggableInfo, dragResult }) => {\r\n    if (getContainer(element).getParentContainer() && isCaptured !== (dragResult.pos !== null)) {\r\n      isCaptured = dragResult.pos !== null;\r\n      getContainer(element)\r\n        .getParentContainer()\r\n        .onChildPositionCaptured(isCaptured);\r\n    }\r\n  };\r\n}\r\n\r\nfunction getElementSize({ layout }) {\r\n  let elementSize = null;\r\n  return ({ draggableInfo, dragResult }) => {\r\n    if (dragResult.pos === null) {\r\n      return (elementSize = null);\r\n    } else {\r\n      elementSize = elementSize || layout.getSize(draggableInfo.element);\r\n    }\r\n    return { elementSize };\r\n  };\r\n}\r\n\r\nfunction handleTargetContainer({ element }) {\r\n  return ({ draggableInfo, dragResult }) => {\r\n    setTargetContainer(draggableInfo, element, !!dragResult.pos);\r\n  };\r\n}\r\n\r\nfunction getDragInsertionIndex({ draggables, layout }) {\r\n  const findDraggable = findDraggebleAtPos({ layout });\r\n  return ({ dragResult: { shadowBeginEnd, pos } }) => {\r\n    if (!shadowBeginEnd) {\r\n      const index = findDraggable(draggables, pos, true);\r\n      return index !== null ? index : draggables.length;\r\n    } else {\r\n      if (shadowBeginEnd.begin + shadowBeginEnd.beginAdjustment <= pos && shadowBeginEnd.end >= pos) {\r\n        // position inside ghost\r\n        return null;\r\n      }\r\n    }\r\n\r\n    if (pos < shadowBeginEnd.begin + shadowBeginEnd.beginAdjustment) {\r\n      return findDraggable(draggables, pos);\r\n    } else if (pos > shadowBeginEnd.end) {\r\n      return findDraggable(draggables, pos) + 1;\r\n    } else {\r\n      return draggables.length;\r\n    }\r\n  };\r\n}\r\n\r\nfunction getDragInsertionIndexForDropZone({ draggables, layout }) {\r\n  return ({ dragResult: { pos } }) => {\r\n    return pos !== null ? { addedIndex: 0 } : { addedIndex: null };\r\n  };\r\n}\r\n\r\nfunction getShadowBeginEndForDropZone({ draggables, layout }) {\r\n  let prevAddedIndex = null;\r\n  return ({ dragResult: { addedIndex } }) => {\r\n    if (addedIndex !== prevAddedIndex) {\r\n      prevAddedIndex = addedIndex;\r\n      const { begin, end } = layout.getBeginEndOfContainer();\r\n      return {\r\n        shadowBeginEnd: {\r\n          rect: layout.getTopLeftOfElementBegin(begin, end)\r\n        }\r\n      };\r\n    }\r\n  };\r\n}\r\n\r\nfunction invalidateShadowBeginEndIfNeeded(params) {\r\n  const shadowBoundsGetter = getShadowBeginEnd(params);\r\n  return ({ draggableInfo, dragResult }) => {\r\n    if (draggableInfo.invalidateShadow) {\r\n      return shadowBoundsGetter({ draggableInfo, dragResult });\r\n    }\r\n    return null;\r\n  };\r\n}\r\n\r\nfunction getNextAddedIndex(params) {\r\n  const getIndexForPos = getDragInsertionIndex(params);\r\n  return ({ dragResult }) => {\r\n    let index = null;\r\n    if (dragResult.pos !== null) {\r\n      index = getIndexForPos({ dragResult });\r\n      if (index === null) {\r\n        index = dragResult.addedIndex;\r\n      }\r\n    }\r\n    return {\r\n      addedIndex: index\r\n    };\r\n  };\r\n}\r\n\r\nfunction resetShadowAdjustment() {\r\n  let lastAddedIndex = null;\r\n  return ({ dragResult: { addedIndex, shadowBeginEnd } }) => {\r\n    if (addedIndex !== lastAddedIndex && lastAddedIndex !== null && shadowBeginEnd) {\r\n      shadowBeginEnd.beginAdjustment = 0;\r\n    }\r\n    lastAddedIndex = addedIndex;\r\n  };\r\n}\r\n\r\nfunction handleInsertionSizeChange({ element, draggables, layout, options }) {\r\n  let strectherElement = null;\r\n  return function({ dragResult: { addedIndex, removedIndex, elementSize } }) {\r\n    if (removedIndex === null) {\r\n      if (addedIndex !== null) {\r\n\t\t\t\tif (!strectherElement) {\r\n\t\t\t\t\tconst containerBeginEnd = layout.getBeginEndOfContainer();\r\n\t\t\t\t\tcontainerBeginEnd.end = containerBeginEnd.begin + layout.getSize(element);\r\n          const hasScrollBar = layout.getScrollSize(element) > layout.getSize(element);\r\n          const containerEnd = hasScrollBar\r\n            ? containerBeginEnd.begin + layout.getScrollSize(element) - layout.getScrollValue(element)\r\n            : containerBeginEnd.end;\r\n          const lastDraggableEnd =\r\n            draggables.length > 0\r\n              ? layout.getBeginEnd(draggables[draggables.length - 1]).end -\r\n                draggables[draggables.length - 1][translationValue]\r\n              : containerBeginEnd.begin;\r\n          if (lastDraggableEnd + elementSize > containerEnd) {\r\n            strectherElement = global.document.createElement('div');\r\n            strectherElement.className = stretcherElementClass + ' ' + options.orientation;\r\n            const stretcherSize = elementSize + lastDraggableEnd - containerEnd;\r\n            layout.setSize(strectherElement.style, `${stretcherSize}px`);\r\n            element.appendChild(strectherElement);\r\n            element[stretcherElementInstance] = strectherElement;\r\n            return {\r\n              containerBoxChanged: true\r\n            };\r\n          }\r\n        }\r\n      } else {\r\n        if (strectherElement) {\r\n          layout.setTranslation(strectherElement, 0);\r\n          let toRemove = strectherElement;\r\n          strectherElement = null;\r\n          element.removeChild(toRemove);\r\n          element[stretcherElementInstance] = null;\r\n          return {\r\n            containerBoxChanged: true\r\n          };\r\n        }\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nfunction calculateTranslations({ element, draggables, layout }) {\r\n  let prevAddedIndex = null;\r\n  let prevRemovedIndex = null;\r\n  return function({ dragResult: { addedIndex, removedIndex, elementSize } }) {\r\n    if (addedIndex !== prevAddedIndex || removedIndex !== prevRemovedIndex) {\r\n      for (let index = 0; index < draggables.length; index++) {\r\n        if (index !== removedIndex) {\r\n          const draggable = draggables[index];\r\n          let translate = 0;\r\n          if (removedIndex !== null && removedIndex < index) {\r\n            translate -= layout.getSize(draggables[removedIndex]);\r\n          }\r\n          if (addedIndex !== null && addedIndex <= index) {\r\n            translate += elementSize;\r\n          }\r\n          layout.setTranslation(draggable, translate);\r\n        }\r\n      }\r\n\r\n      prevAddedIndex = addedIndex;\r\n      prevRemovedIndex = removedIndex;\r\n\r\n      return { addedIndex, removedIndex };\r\n    }\r\n  };\r\n}\r\n\r\nfunction getShadowBeginEnd({ draggables, layout }) {\r\n  let prevAddedIndex = null;\r\n  return ({ draggableInfo, dragResult }) => {\r\n    const { addedIndex, removedIndex, elementSize, pos, shadowBeginEnd } = dragResult;\r\n    if (pos !== null) {\r\n      if (addedIndex !== null && (draggableInfo.invalidateShadow || addedIndex !== prevAddedIndex)) {\r\n        if (prevAddedIndex) prevAddedIndex = addedIndex;\r\n        let beforeIndex = addedIndex - 1;\r\n        let begin = 0;\r\n        let afterBounds = null;\r\n        let beforeBounds = null;\r\n        if (beforeIndex === removedIndex) {\r\n          beforeIndex--;\r\n        }\r\n        if (beforeIndex > -1) {\r\n          const beforeSize = layout.getSize(draggables[beforeIndex]);\r\n          beforeBounds = layout.getBeginEnd(draggables[beforeIndex]);\r\n          if (elementSize < beforeSize) {\r\n            const threshold = (beforeSize - elementSize) / 2;\r\n            begin = beforeBounds.end - threshold;\r\n          } else {\r\n            begin = beforeBounds.end;\r\n          }\r\n        } else {\r\n          beforeBounds = { end: layout.getBeginEndOfContainer().begin };\r\n        }\r\n\r\n        let end = 10000;\r\n        let afterIndex = addedIndex;\r\n        if (afterIndex === removedIndex) {\r\n          afterIndex++;\r\n        }\r\n        if (afterIndex < draggables.length) {\r\n          const afterSize = layout.getSize(draggables[afterIndex]);\r\n          afterBounds = layout.getBeginEnd(draggables[afterIndex]);\r\n\r\n          if (elementSize < afterSize) {\r\n            const threshold = (afterSize - elementSize) / 2;\r\n            end = afterBounds.begin + threshold;\r\n          } else {\r\n            end = afterBounds.begin;\r\n          }\r\n        } else {\r\n          afterBounds = { begin: layout.getContainerRectangles().end };\r\n        }\r\n\r\n        const shadowRectTopLeft =\r\n          beforeBounds && afterBounds ? layout.getTopLeftOfElementBegin(beforeBounds.end, afterBounds.begin) : null;\r\n\r\n        return {\r\n          shadowBeginEnd: {\r\n            begin,\r\n            end,\r\n            rect: shadowRectTopLeft,\r\n            beginAdjustment: shadowBeginEnd ? shadowBeginEnd.beginAdjustment : 0\r\n          }\r\n        };\r\n      } else {\r\n        return null;\r\n      }\r\n    } else {\r\n      prevAddedIndex = null;\r\n      return {\r\n        shadowBeginEnd: null\r\n      };\r\n    }\r\n  };\r\n}\r\n\r\nfunction handleFirstInsertShadowAdjustment() {\r\n  let lastAddedIndex = null;\r\n  return ({ dragResult: { pos, addedIndex, shadowBeginEnd }, draggableInfo: { invalidateShadow } }) => {\r\n    if (pos !== null) {\r\n      if (addedIndex != null && lastAddedIndex === null) {\r\n        if (pos < shadowBeginEnd.begin) {\r\n          const beginAdjustment = pos - shadowBeginEnd.begin - 5;\r\n          shadowBeginEnd.beginAdjustment = beginAdjustment;\r\n        }\r\n        lastAddedIndex = addedIndex;\r\n      }\r\n    } else {\r\n      lastAddedIndex = null;\r\n    }\r\n  };\r\n}\r\n\r\nfunction fireDragEnterLeaveEvents({ options }) {\r\n  let wasDragIn = false;\r\n  return ({ dragResult: { pos } }) => {\r\n    const isDragIn = !!pos;\r\n    if (isDragIn !== wasDragIn) {\r\n      wasDragIn = isDragIn;\r\n      if (isDragIn) {\r\n        options.onDragEnter && options.onDragEnter();\r\n      } else {\r\n        options.onDragLeave && options.onDragLeave();\r\n        return {\r\n          dragLeft: true\r\n        };\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nfunction getDragHandler(params) {\r\n  if (params.options.behaviour === 'drop-zone') {\r\n    // sorting is disabled in container, addedIndex will always be 0 if dropped in\r\n    return compose(params)(\r\n      getRemovedItem,\r\n      setRemovedItemVisibilty,\r\n      getPosition,\r\n      notifyParentOnPositionCapture,\r\n      getElementSize,\r\n      handleTargetContainer,\r\n      getDragInsertionIndexForDropZone,\r\n      getShadowBeginEndForDropZone,\r\n      fireDragEnterLeaveEvents\r\n    );\r\n  } else {\r\n    return compose(params)(\r\n      getRemovedItem,\r\n      setRemovedItemVisibilty,\r\n      getPosition,\r\n      notifyParentOnPositionCapture,\r\n      getElementSize,\r\n      handleTargetContainer,\r\n      invalidateShadowBeginEndIfNeeded,\r\n      getNextAddedIndex,\r\n      resetShadowAdjustment,\r\n      handleInsertionSizeChange,\r\n      calculateTranslations,\r\n      getShadowBeginEnd,\r\n      handleFirstInsertShadowAdjustment,\r\n      fireDragEnterLeaveEvents\r\n    );\r\n  }\r\n}\r\n\r\nfunction getDefaultDragResult() {\r\n  return {\r\n    addedIndex: null,\r\n    removedIndex: null,\r\n    elementSize: null,\r\n    pos: null,\r\n    shadowBeginEnd: null\r\n  };\r\n}\r\n\r\nfunction compose(params) {\r\n  return (...functions) => {\r\n    const hydratedFunctions = functions.map(p => p(params));\r\n    let result = null;\r\n    return draggableInfo => {\r\n      result = hydratedFunctions.reduce((dragResult, fn) => {\r\n        return Object.assign(dragResult, fn({ draggableInfo, dragResult }));\r\n      }, result || getDefaultDragResult());\r\n      return result;\r\n    };\r\n  };\r\n}\r\n\r\n// Container definition begin\r\nfunction Container(element) {\r\n  return function(options) {\r\n    let dragResult = null;\r\n    let lastDraggableInfo = null;\r\n    const props = getContainerProps(element, options);\r\n    let dragHandler = getDragHandler(props);\r\n    let dropHandler = handleDrop(props);\r\n    let parentContainer = null;\r\n    let posIsInChildContainer = false;\r\n    let childContainers = [];\r\n\r\n    function processLastDraggableInfo() {\r\n      if (lastDraggableInfo !== null) {\r\n        lastDraggableInfo.invalidateShadow = true;\r\n        dragResult = dragHandler(lastDraggableInfo);\r\n        lastDraggableInfo.invalidateShadow = false;\r\n      }\r\n    }\r\n\r\n    function onChildPositionCaptured(isCaptured) {\r\n      posIsInChildContainer = isCaptured;\r\n      if (parentContainer) {\r\n        parentContainer.onChildPositionCaptured(isCaptured);\r\n        if (lastDraggableInfo) {\r\n          dragResult = dragHandler(lastDraggableInfo);\r\n        }\r\n      }\r\n    }\r\n\r\n    function setDraggables(draggables, element, options) {\r\n      const newDraggables = wrapChildren(element, options.orientation, options.animationDuration);\r\n      for (let i = 0; i < newDraggables.length; i++) {\r\n        draggables[i] = newDraggables[i];\r\n      }\r\n\r\n      for (let i = 0; i < draggables.length - newDraggables.length; i++) {\r\n        draggables.pop();\r\n      }\r\n    }\r\n\r\n    function prepareDrag(container, relevantContainers) {\r\n      const element = container.element;\r\n      const draggables = props.draggables;\r\n      const options = container.getOptions();\r\n      setDraggables(draggables, element, options);\r\n      container.layout.invalidateRects();\r\n      registerToParentContainer(container, relevantContainers);\r\n      draggables.forEach(p => setAnimation(p, true, options.animationDuration));\r\n    }\r\n\r\n    props.layout.setScrollListener(function() {\r\n      processLastDraggableInfo();\r\n    });\r\n\r\n    function handleDragLeftDeferedTranslation() {\r\n      if (dragResult.dragLeft && props.options.behaviour !== 'drop-zone') {\r\n        dragResult.dragLeft = false;\r\n        setTimeout(() => {\r\n          if (dragResult) calculateTranslations(props)({ dragResult });\r\n        }, 20);\r\n      }\r\n    }\r\n\r\n    function dispose(container) {\r\n      unwrapChildren(container.element);\r\n      removeClass(container.element, containerClass);\r\n      removeClass(container.element, container.getOptions().orientation);\r\n    }\r\n\r\n    return {\r\n      element,\r\n      draggables: props.draggables,\r\n      isDragRelevant: isDragRelevant(props),\r\n      getScale: props.layout.getContainerScale,\r\n      layout: props.layout,\r\n      getChildContainers: () => childContainers,\r\n      onChildPositionCaptured,\r\n      dispose,\r\n      prepareDrag,\r\n      isPosInChildContainer: () => posIsInChildContainer,\r\n      handleDrag: function(draggableInfo) {\r\n        lastDraggableInfo = draggableInfo;\r\n        dragResult = dragHandler(draggableInfo);\r\n        handleDragLeftDeferedTranslation();\r\n        return dragResult;\r\n      },\r\n      handleDrop: function(draggableInfo) {\r\n        lastDraggableInfo = null;\r\n        onChildPositionCaptured(false);\r\n        dragHandler = getDragHandler(props);\r\n        dropHandler(draggableInfo, dragResult);\r\n        dragResult = null;\r\n        parentContainer = null;\r\n        childContainers = [];\r\n      },\r\n      getDragResult: function() {\r\n        return dragResult;\r\n      },\r\n      getTranslateCalculator: function(...params) {\r\n        return calculateTranslations(props)(...params);\r\n      },\r\n      setParentContainer: e => {\r\n        parentContainer = e;\r\n      },\r\n      getParentContainer: () => parentContainer,\r\n      onTranslated: () => {\r\n        processLastDraggableInfo();\r\n      },\r\n      getOptions: () => props.options,\r\n      setDraggables: () => {\r\n        setDraggables(props.draggables, element, props.options);\r\n      }\r\n    };\r\n  };\r\n}\r\n\r\nconst options = {\r\n  behaviour: 'move',\r\n  groupName: 'bla bla', // if not defined => container will not interfere with other containers\r\n  orientation: 'vertical',\r\n  dragHandleSelector: null,\r\n  nonDragAreaSelector: 'some selector',\r\n  dragBeginDelay: 0,\r\n  animationDuration: 180,\r\n  autoScrollEnabled: true,\r\n  lockAxis: true,\r\n  dragClass: null,\r\n  dropClass: null,\r\n  onDragStart: (index, payload) => {},\r\n  onDrop: ({ removedIndex, addedIndex, payload, element }) => {},\r\n  getChildPayload: index => null,\r\n  shouldAnimateDrop: (sourceContainerOptions, payload) => true,\r\n  shouldAcceptDrop: (sourceContainerOptions, payload) => true,\r\n  onDragEnter: () => {},\r\n  onDragLeave: () => {}\r\n};\r\n\r\n// exported part of container\r\nfunction SmoothDnD(element, options) {\r\n  const containerIniter = Container(element);\r\n    \r\n  \r\n  function initContainer(element, options) {\r\n    const dndContainer = containerIniter(options);\r\n    element[containerInstance] = dndContainer;\r\n    Mediator.register(dndContainer);\r\n    return dndContainer;\r\n  }\r\n\r\n  var container = initContainer(element, options);\r\n\r\n  function dispose() {\r\n    Mediator.unregister(container);\r\n    container.layout.dispose();\r\n    container.dispose(container);\r\n  }\r\n\r\n  return {\r\n    dispose,\r\n    setOptions: function(newOptions) {\r\n      const mergedOptions = Object.assign({}, container.getOptions(), newOptions);\r\n      dispose();\r\n      container = initContainer(element, mergedOptions);\r\n    }\r\n  };\r\n}\r\n\r\nexport default SmoothDnD;\r\n","\r\nexport const applyDrag = (arr, dragResult) => {\r\n\tconst { removedIndex, addedIndex, payload } = dragResult;\r\n\tif (removedIndex === null && addedIndex === null) return arr;\r\n\r\n\tconst result = [...arr];\r\n\tlet itemToAdd = payload;\r\n\r\n\tif (removedIndex !== null) {\r\n\t\titemToAdd = result.splice(removedIndex, 1)[0];\r\n\t}\r\n\r\n\tif (addedIndex !== null) {\r\n\t\tresult.splice(addedIndex, 0, itemToAdd);\r\n\t}\r\n\r\n\treturn result;\r\n};\r\n\r\nexport const generateItems = (count, creator) => {\r\n\tconst result = [];\r\n\tfor (let i = 0; i < count; i++) {\r\n\t\tresult.push(creator(i));\r\n\t}\r\n\treturn result;\r\n};","import Container from '../../smooth-dnd/src/container';\r\nimport { applyDrag, generateItems } from \"./utils\";\r\n\r\nconst lorem = `Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. \r\nExcepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. \r\nExcepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.`;\r\n\r\nconst columnNames = [\"Lorem\", \"Ipsum\", \"Consectetur\", \"Eiusmod\"];\r\n\r\nconst cardColors = [\r\n\t\"azure\",\r\n\t\"beige\",\r\n\t\"bisque\",\r\n\t\"blanchedalmond\",\r\n\t\"burlywood\",\r\n\t\"cornsilk\",\r\n\t\"gainsboro\",\r\n\t\"ghostwhite\",\r\n\t\"ivory\",\r\n\t\"khaki\"\r\n];\r\nconst pickColor = () => {\r\n\tlet rand = Math.floor(Math.random() * 10);\r\n\treturn cardColors[rand];\r\n};\r\n\r\nexport const addChildAt = (parent, child, index) => {\r\n\tif (index >= parent.children.length) {\r\n\t\tparent.appendChild(child);\r\n\t} else {\r\n\t\tparent.insertBefore(child, parent.children[index]);\r\n\t}\r\n};\r\n\r\nfunction createVerticalContainer(cardCount) {\r\n\tconst container = document.createElement('div');\r\n\r\n\tfor (var i = 0; i < cardCount; i++) {\r\n\t\tconst wrapper = document.createElement('div');\r\n\t\tconst card = document.createElement('div');\r\n\t\tcard.className = 'card';\r\n\t\tcard.innerText = lorem.slice(0, Math.floor(Math.random() * 150) + 30)\r\n\t\twrapper.appendChild(card);\r\n\t\tcontainer.appendChild(wrapper);\r\n\t}\r\n\r\n\treturn container;\r\n}\r\n\r\nfunction initScene(colCount) {\r\n\tconst cardScene = document.querySelector('.card-scene');\r\n\tconst mainContainer = document.createElement('div');\r\n\tconst innerContainers = [];\r\n\r\n\tfor (var i = 0; i < colCount; i++) {\r\n\t\tconst draggable = document.createElement('div');\r\n\t\tconst verticalContainerHolder = document.createElement('div');\r\n\t\tconst header = document.createElement('div');\r\n\t\theader.className = 'card-column-header';\r\n\t\theader.innerHTML = '<span class=\"column-drag-handle\">&#x2630;</span> Header';\r\n\t\tverticalContainerHolder.appendChild(header);\r\n\t\tdraggable.appendChild(verticalContainerHolder);\r\n\t\tverticalContainerHolder.className = 'card-container';\r\n\t\tconst innerContainer = createVerticalContainer(+(Math.random() * 10).toFixed() + 5);\r\n\t\tinnerContainers.push(innerContainer);\r\n\t\tverticalContainerHolder.appendChild(innerContainer);\r\n\t\tmainContainer.appendChild(draggable);\r\n\t}\r\n\r\n\tcardScene.appendChild(mainContainer);\r\n\r\n\treturn {\r\n\t\tmainContainer,\r\n\t\tinnerContainers\r\n\t}\r\n}\r\n\r\nlet verticalContainers;\r\n\r\nfunction main() {\r\n\tconst containers = initScene(5);\r\n\r\n\tfunction onDrop(dropResult, containerElement) {\r\n\t\tconst { removedIndex, addedIndex, droppedElement } = dropResult;\r\n\r\n\t\tif (addedIndex !== null) {\r\n\t\t\tlet dropped = droppedElement;\r\n\t\t\taddChildAt(containerElement, dropped, removedIndex !== null && removedIndex < addedIndex ? addedIndex + 1: addedIndex);\r\n\t\t}\r\n\t}\r\n\r\n\tconst mainContainer = Container(containers.mainContainer, {\r\n\t\torientation: 'horizontal',\r\n\t\tonDrop: (p) => onDrop(p, containers.mainContainer)\r\n\t});\r\n\r\n\tverticalContainers = containers.innerContainers.map(p => {\r\n\t\treturn Container(p, {\r\n\t\t\tgroupName: 'cards',\r\n\t\t\tonDrop: (q) => onDrop(q, p)\r\n\t\t});\r\n\t})\r\n}\r\n\r\nmain();\r\n\r\nconst btn = document.getElementById('btn-setoptions');\r\n\r\nbtn.addEventListener('click', function() {\r\n\tverticalContainers[0].setOptions({\r\n\t\tbehaviour: 'copy'\r\n\t})\r\n})"]}